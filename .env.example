# =============================================================================
# QE MCP Stack Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values
# DO NOT commit .env to version control!

# =============================================================================
# Node Environment
# =============================================================================
NODE_ENV=development

# =============================================================================
# Azure DevOps Configuration
# =============================================================================
# Required for Azure DevOps MCP and Test Plan Manager MCP
# Get your PAT from: https://dev.azure.com/[your-org]/_usersSettings/tokens

AZURE_DEVOPS_ORG=your-organization-name
AZURE_DEVOPS_PAT=your-personal-access-token-here
AZURE_DEVOPS_PROJECT=your-project-name

# Azure DevOps API URL (usually this default is correct)
AZURE_DEVOPS_API_URL=https://dev.azure.com

# =============================================================================
# Anthropic API Configuration
# =============================================================================
# Required for AI-powered MCPs: Risk Analyzer, Test Selector, Playwright Generator
# Get your API key from: https://console.anthropic.com/account/keys

ANTHROPIC_API_KEY=your-anthropic-api-key-here

# Optional: Model configuration
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
ANTHROPIC_MAX_TOKENS=4096

# =============================================================================
# OpenAI API Configuration
# =============================================================================
# Optional: Used by Risk Analyzer for additional AI analysis
# Get your API key from: https://platform.openai.com/api-keys

OPENAI_API_KEY=sk-your-openai-api-key-here

# Optional: Model configuration
OPENAI_MODEL=gpt-4
OPENAI_MAX_TOKENS=4096

# =============================================================================
# Stripe API Configuration
# =============================================================================
# Required for Third-Party Integrations MCP
# Get your API key from: https://dashboard.stripe.com/test/apikeys

STRIPE_API_KEY=sk_test_your-stripe-test-key-here
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret-here

# =============================================================================
# Application Repository Paths
# =============================================================================
# Absolute paths to your local application repositories
# These are mounted as read-only volumes in Docker containers
# Update these paths to match your local development environment

CORE_REPO_PATH=/Users/williambigno/dev/git/Core
CORE_COMMON_REPO_PATH=/Users/williambigno/dev/git/Core.Common
PAYMENTS_REPO_PATH=/Users/williambigno/dev/git/Payments
PRECARE_REPO_PATH=/Users/williambigno/dev/git/PreCare
THIRD_PARTY_REPO_PATH=/Users/williambigno/dev/git/ThirdPartyIntegrations

# =============================================================================
# Application URLs
# =============================================================================
# URLs for the deployed applications (for E2E testing)
# Update these to match your environment (local, dev, staging, prod)

CORE_APP_URL=http://localhost:5000
CORE_COMMON_APP_URL=http://localhost:5001
PAYMENTS_APP_URL=http://localhost:5002
PRECARE_APP_URL=http://localhost:5003
THIRD_PARTY_APP_URL=http://localhost:5004

# =============================================================================
# Database Configuration (if needed for integration tests)
# =============================================================================
# Connection strings for test databases
# Only required if you have database integration tests

# Core application database
CORE_DB_CONNECTION_STRING=Server=localhost;Database=Core_Test;User Id=sa;Password=YourPassword123!;TrustServerCertificate=True

# Core.Common application database
CORE_COMMON_DB_CONNECTION_STRING=Server=localhost;Database=CoreCommon_Test;User Id=sa;Password=YourPassword123!;TrustServerCertificate=True

# Payments application database
PAYMENTS_DB_CONNECTION_STRING=Server=localhost;Database=Payments_Test;User Id=sa;Password=YourPassword123!;TrustServerCertificate=True

# PreCare application database
PRECARE_DB_CONNECTION_STRING=Server=localhost;Database=PreCare_Test;User Id=sa;Password=YourPassword123!;TrustServerCertificate=True

# =============================================================================
# Service URLs (Docker internal networking)
# =============================================================================
# These are used by the orchestrator to communicate with MCPs
# Default values work for Docker Compose setup

ORCHESTRATOR_URL=http://orchestrator:3000
AZURE_DEVOPS_MCP_URL=http://azure-devops:8100
THIRD_PARTY_MCP_URL=http://third-party:8101
TEST_PLAN_MANAGER_MCP_URL=http://test-plan-manager:8102
CODE_ANALYZER_MCP_URL=http://code-analyzer:8200
COVERAGE_ANALYZER_MCP_URL=http://coverage-analyzer:8201
PLAYWRIGHT_GENERATOR_MCP_URL=http://playwright-generator:8202
MIGRATION_ANALYZER_MCP_URL=http://migration-analyzer:8203
RISK_ANALYZER_MCP_URL=http://risk-analyzer:8300
INTEGRATION_MAPPER_MCP_URL=http://integration-mapper:8301
TEST_SELECTOR_MCP_URL=http://test-selector:8302

# =============================================================================
# Service Ports (for local development outside Docker)
# =============================================================================
# These are used when running services directly with npm (not in Docker)

ORCHESTRATOR_PORT=3000
DASHBOARD_PORT=5173
SWAGGER_HUB_PORT=8000

AZURE_DEVOPS_MCP_PORT=8100
THIRD_PARTY_MCP_PORT=8101
TEST_PLAN_MANAGER_MCP_PORT=8102

CODE_ANALYZER_MCP_PORT=8200
COVERAGE_ANALYZER_MCP_PORT=8201
PLAYWRIGHT_GENERATOR_MCP_PORT=8202
MIGRATION_ANALYZER_MCP_PORT=8203

RISK_ANALYZER_MCP_PORT=8300
INTEGRATION_MAPPER_MCP_PORT=8301
TEST_SELECTOR_MCP_PORT=8302

# =============================================================================
# Playwright Configuration
# =============================================================================
# Base URL for Playwright tests
BASE_URL=http://localhost:8001

# Browser configuration
PLAYWRIGHT_BROWSERS=chromium,firefox,webkit
PLAYWRIGHT_HEADLESS=true
PLAYWRIGHT_SLOW_MO=0

# Test execution
PLAYWRIGHT_WORKERS=4
PLAYWRIGHT_RETRIES=2
PLAYWRIGHT_TIMEOUT=30000

# Test artifacts
PLAYWRIGHT_SCREENSHOTS=only-on-failure
PLAYWRIGHT_VIDEO=retain-on-failure
PLAYWRIGHT_TRACE=on-first-retry

# =============================================================================
# Logging Configuration
# =============================================================================
# Log levels: error, warn, info, http, verbose, debug, silly
LOG_LEVEL=info

# Log format: json, simple, combined
LOG_FORMAT=json

# Log to file (true/false)
LOG_TO_FILE=true
LOG_FILE_PATH=./logs

# =============================================================================
# MCP Configuration
# =============================================================================
# Global settings for all MCPs

# Enable Swagger UI on all MCPs
ENABLE_SWAGGER=true

# API rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# CORS configuration
CORS_ORIGIN=*
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_CREDENTIALS=true

# =============================================================================
# Code Analysis Configuration
# =============================================================================
# Settings for code analysis MCPs

# Complexity thresholds
COMPLEXITY_WARNING_THRESHOLD=10
COMPLEXITY_ERROR_THRESHOLD=20

# Coverage thresholds
COVERAGE_WARNING_THRESHOLD=60
COVERAGE_ERROR_THRESHOLD=40

# Analysis exclusions (comma-separated patterns)
ANALYSIS_EXCLUDE_PATTERNS=**/bin/**,**/obj/**,**/node_modules/**,**/packages/**,**/.git/**

# =============================================================================
# Migration Configuration
# =============================================================================
# Settings for Core â†’ Core.Common migration tracking

# Migration tracking enabled
MIGRATION_TRACKING_ENABLED=true

# Source and target repos for migration
MIGRATION_SOURCE_REPO=Core
MIGRATION_TARGET_REPO=Core.Common

# =============================================================================
# Test Execution Configuration
# =============================================================================
# Settings for test plan execution and management

# Test execution timeout (milliseconds)
TEST_EXECUTION_TIMEOUT=300000

# Parallel test execution
TEST_PARALLEL_ENABLED=true
TEST_PARALLEL_WORKERS=4

# Test result retention (days)
TEST_RESULT_RETENTION_DAYS=90

# =============================================================================
# Security Configuration
# =============================================================================
# API authentication and security settings

# JWT secret for API authentication (generate with: openssl rand -hex 32)
JWT_SECRET=your-jwt-secret-key-here-generate-with-openssl-rand

# JWT expiration
JWT_EXPIRATION=24h

# API keys for service-to-service authentication
# Generate unique keys for each environment
ORCHESTRATOR_API_KEY=your-orchestrator-api-key-here
DASHBOARD_API_KEY=your-dashboard-api-key-here

# =============================================================================
# Cache Configuration
# =============================================================================
# Redis or in-memory cache settings

# Cache enabled
CACHE_ENABLED=true

# Cache TTL (seconds)
CACHE_TTL=3600

# Cache type: redis or memory
CACHE_TYPE=memory

# Redis configuration (if using Redis)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# =============================================================================
# Monitoring & Observability
# =============================================================================
# Optional monitoring and telemetry configuration

# Health check interval (milliseconds)
HEALTH_CHECK_INTERVAL=30000

# Metrics collection enabled
METRICS_ENABLED=false

# OpenTelemetry configuration (optional)
OTEL_ENABLED=false
OTEL_COLLECTOR_URL=http://localhost:4318
OTEL_SERVICE_NAME=qe-mcp-stack

# =============================================================================
# CI/CD Configuration
# =============================================================================
# Settings for CI/CD pipelines

# CI environment detection
CI=false

# GitHub Actions specific
GITHUB_TOKEN=your-github-token-here
GITHUB_REPOSITORY=your-org/qe-mcp-stack

# Test reporting
TEST_REPORT_ENABLED=true
TEST_REPORT_FORMAT=junit,html,json

# =============================================================================
# Development Tools
# =============================================================================
# Settings for development and debugging

# Hot reload enabled
HOT_RELOAD=true

# Source maps enabled
SOURCE_MAPS=true

# Debug mode
DEBUG=false
DEBUG_PORT=9229

# Mock external services in development
MOCK_EXTERNAL_SERVICES=false

# =============================================================================
# Feature Flags
# =============================================================================
# Enable/disable specific features

# Enable experimental features
FEATURE_EXPERIMENTAL=false

# Enable AI-powered features
FEATURE_AI_ENABLED=true

# Enable migration tracking
FEATURE_MIGRATION_TRACKING=true

# Enable test generation
FEATURE_TEST_GENERATION=true

# Enable risk analysis
FEATURE_RISK_ANALYSIS=true

# =============================================================================
# Email Configuration (optional)
# =============================================================================
# Email notifications for test results and alerts

EMAIL_ENABLED=false
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_SECURE=false
EMAIL_USER=your-email@example.com
EMAIL_PASSWORD=your-email-password
EMAIL_FROM=QE MCP Stack <noreply@example.com>

# Notification recipients (comma-separated)
EMAIL_RECIPIENTS=team@example.com

# =============================================================================
# Slack Integration (optional)
# =============================================================================
# Slack notifications for test results and alerts

SLACK_ENABLED=false
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_CHANNEL=#qe-automation
SLACK_USERNAME=QE MCP Stack

# =============================================================================
# Notes
# =============================================================================
#
# Required Variables (Minimum to get started):
# - AZURE_DEVOPS_ORG
# - AZURE_DEVOPS_PAT
# - AZURE_DEVOPS_PROJECT
# - ANTHROPIC_API_KEY
# - STRIPE_API_KEY
# - Application repository paths (CORE_REPO_PATH, etc.)
#
# For local development outside Docker:
# - Update all *_REPO_PATH variables to your local paths
# - Update all *_APP_URL variables to your running application URLs
#
# For Docker deployment:
# - Repository paths should be absolute paths on the host machine
# - Service URLs use Docker internal networking (defaults are correct)
#
# Security:
# - NEVER commit the .env file to version control
# - Add .env to .gitignore
# - Rotate API keys and secrets regularly
# - Use different values for dev, staging, and production environments
#
